{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.9", "generated_at": "2025-09-07T10:15:37.310100Z", "invocation_id": "633f1a4a-ddc1-4c33-a160-623bb140d3d7", "invocation_started_at": "2025-09-07T10:15:26.720411Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:15:35.527442Z", "completed_at": "2025-09-07T10:15:35.539074Z"}, {"name": "execute", "started_at": "2025-09-07T10:15:35.539527Z", "completed_at": "2025-09-07T10:15:37.267134Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.7415430545806885, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-southeast1", "project_id": "project-github-471211", "job_id": "beac2965-e695-4f75-80ef-36a093c36af0", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.wide_world_importers_dbt.dim_customer", "compiled": true, "compiled_code": "WITH dim_customer__source AS(  \n  SELECT *  \n  FROM `vit-lam-data.wide_world_importers.sales__customers`  \n),  \n\ndim_customer__renamed AS(  \n  SELECT  \n    customer_id AS customer_key,  \n    customer_name,  \n    is_statement_sent,  \n    is_on_credit_hold,  \n    payment_days,  \n    credit_limit,  \n    account_opened_date,  \n    customer_category_id AS customer_category_key,  \n    buying_group_id AS customer_buying_group_key,  \n    delivery_method_id AS delivery_method_key,  \n    delivery_city_id AS delivery_city_key,  \n    postal_city_id AS postal_city_key,  \n    primary_contact_person_id AS primary_contact_person_key,  \n    bill_to_customer_id AS bill_to_customer_key  \n  FROM dim_customer__source  \n),  \n\ndim_customer__convert AS (  \n  SELECT  \n    CAST(customer_key AS INT64) AS customer_key,  \n    CAST(customer_name AS STRING) AS customer_name,  \n    CAST(is_statement_sent AS BOOL) AS is_statement_sent,  \n    CAST(is_on_credit_hold AS BOOL) AS is_on_credit_hold,  \n    CAST(payment_days AS INT64) AS payment_days,  \n    CAST(credit_limit AS FLOAT64) AS credit_limit,  \n    CAST(account_opened_date AS DATE) AS account_opened_date,  \n    CAST(customer_category_key AS INT64) AS customer_category_key,  \n    CAST(customer_buying_group_key AS INT64) AS customer_buying_group_key,  \n    CAST(delivery_method_key AS INT64) AS delivery_method_key,  \n    CAST(delivery_city_key AS INT64) AS delivery_city_key,  \n    CAST(postal_city_key AS INT64) AS postal_city_key,  \n    CAST(primary_contact_person_key AS INT64) AS primary_contact_person_key,  \n    CAST(bill_to_customer_key AS INT64) AS bill_to_customer_key  \n  FROM dim_customer__renamed  \n),  \n\ndim_customer_convert__boolean AS (  \n  SELECT  \n    *,  \n    CASE  \n      WHEN is_statement_sent IS TRUE THEN 'on_is_statement_sent'  \n      WHEN is_statement_sent IS FALSE THEN 'off_is_statement_sent'  \n      ELSE 'unknown_is_statement_sent'  \n    END AS is_statement_sent_flag,  \n    CASE  \n      WHEN is_on_credit_hold IS TRUE THEN 'on_is_on_credit_hold'  \n      WHEN is_on_credit_hold IS FALSE THEN 'off_is_on_credit_hold'  \n      ELSE 'unknown_is_on_credit_hold'  \n    END AS is_on_credit_hold_flag  \n  FROM dim_customer__convert  \n),  \n\ndim_customer_undefined__record AS (  \n  SELECT   \n    customer_key,  \n    customer_name,  \n    is_statement_sent_flag,\n    is_on_credit_hold_flag,\n    account_opened_date,  \n    payment_days,  \n    credit_limit,  \n    customer_category_key,  \n    customer_buying_group_key,  \n    delivery_method_key,  \n    delivery_city_key,  \n    postal_city_key,  \n    primary_contact_person_key,  \n    bill_to_customer_key  \n  FROM dim_customer_convert__boolean  \n\n  UNION ALL  \n\n  SELECT  \n    0 AS customer_key,  \n    'undefined' AS customer_name,  \n    'unknown_is_statement_sent' AS is_statement_sent_flag,  \n    'unknown_is_on_credit_hold' AS is_on_credit_hold_flag,  \n    DATE '1970-01-01' AS account_opened_date,  \n    0 AS payment_days,  \n    0.0 AS credit_limit,  \n    0 AS customer_category_key,  \n    0 AS customer_buying_group_key,  \n    0 AS delivery_method_key,  \n    0 AS delivery_city_key,  \n    0 AS postal_city_key,  \n    0 AS primary_contact_person_key,  \n    0 AS bill_to_customer_key  \n\n  UNION ALL  \n\n  SELECT  \n    -1 AS customer_key,  \n    'invalid' AS customer_name,  \n    'unknown_is_statement_sent' AS is_statement_sent_flag,  \n    'unknown_is_on_credit_hold' AS is_on_credit_hold_flag,  \n    DATE '1970-01-01' AS account_opened_date,  \n    -1 AS payment_days,  \n    -1.0 AS credit_limit,  \n    -1 AS customer_category_key,  \n    -1 AS customer_buying_group_key,  \n    -1 AS delivery_method_key,  \n    -1 AS delivery_city_key,  \n    -1 AS postal_city_key,  \n    -1 AS primary_contact_person_key,  \n    -1 AS bill_to_customer_key  \n),  \n\ndim_customer__join AS (  \n  SELECT  \n    customer.customer_key,\n    customer.customer_name,\n    customer.is_statement_sent_flag AS is_statement_send,\n    customer.is_on_credit_hold_flag AS is_on_credit_holds,\n    customer.payment_days,\n    customer.credit_limit,\n    customer.account_opened_date,\n    customer.customer_category_key,\n    category.customer_category_name,\n    customer.customer_buying_group_key,\n    buying_group.buying_group_name,\n    customer.delivery_method_key,\n    customer.delivery_city_key,\n    city.city_name AS delivery_city_name,\n    city.state_province_key AS delivery_state_province_key,\n    city.state_province_name AS delivery_state_province_name,\n    customer.postal_city_key,\n    city.city_name AS postal_city_name,\n    customer.primary_contact_person_key,\n    person.full_name ,\n    person.preferred_name ,\n    person.search_name \nFROM dim_customer_undefined__record AS customer\nLEFT JOIN `project-github-471211`.`wide_world_importers_dwh`.`stg_dim_category` AS category\nON customer.customer_category_key = category.customer_category_key\nLEFT JOIN `project-github-471211`.`wide_world_importers_dwh`.`stg_dim_buying_group` AS buying_group\nON customer.customer_buying_group_key = buying_group.buying_group_key\nLEFT JOIN `project-github-471211`.`wide_world_importers_dwh`.`dim_city` AS city\nON customer.delivery_city_key = city.city_key\nLEFT JOIN `project-github-471211`.`wide_world_importers_dwh`.`stg_dim_person` AS person\nON customer.primary_contact_person_key = person.person_key\n)\nSELECT \n  customer_key,\n  customer_name,\n  is_statement_send,\n  is_on_credit_holds,\n  payment_days,\n  credit_limit,\n  account_opened_date,\n  customer_category_key,\n  customer_category_name,\n  COALESCE(customer_buying_group_key, 0) AS customer_buying_group_key,\n  COALESCE(buying_group_name, 'Undefined') AS buying_group_name,\n  delivery_method_key,\n  delivery_city_key,\n  delivery_city_name,\n  postal_city_key,\n  postal_city_name,\n  primary_contact_person_key,\n  full_name ,\n  preferred_name ,\n  search_name \nFROM dim_customer__join", "relation_name": "`project-github-471211`.`wide_world_importers_dwh`.`dim_customer`", "batch_results": null}], "elapsed_time": 3.0440776348114014, "args": {"introspect": true, "require_all_warnings_handled_by_warn_error": false, "state_modified_compare_more_unrendered_values": false, "require_generic_test_arguments_property": true, "require_nested_cumulative_type_params": false, "which": "run", "show_resource_report": false, "use_colors": true, "strict_mode": false, "use_colors_file": true, "version_check": true, "exclude": [], "log_file_max_bytes": 10485760, "profiles_dir": "D:\\data_warehouse_project", "invocation_command": "dbt run --select dim_customer", "static_parser": true, "log_path": "D:\\data_warehouse_project\\logs", "populate_cache": true, "state_modified_compare_vars": false, "macro_debugging": false, "vars": {}, "require_explicit_package_overrides_for_builtin_materializations": true, "validate_macro_args": false, "log_format_file": "debug", "defer": false, "log_format": "default", "warn_error_options": {"error": [], "warn": [], "silence": []}, "use_fast_test_edges": false, "project_dir": "D:\\data_warehouse_project", "upload_to_artifacts_ingest_api": false, "write_json": true, "printer_width": 80, "skip_nodes_if_on_run_start_fails": false, "print": true, "empty": false, "partial_parse_file_diff": true, "quiet": false, "log_level_file": "debug", "select": ["dim_customer"], "send_anonymous_usage_stats": true, "partial_parse": true, "cache_selected_only": false, "show_all_deprecations": false, "indirect_selection": "eager", "log_level": "info", "require_batched_execution_for_custom_microbatch_strategy": false, "require_resource_names_without_spaces": true, "favor_state": false, "require_yaml_configuration_for_mf_time_spines": false, "source_freshness_run_project_hooks": true}}